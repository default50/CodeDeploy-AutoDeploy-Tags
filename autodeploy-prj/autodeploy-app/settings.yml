lambdas:
  autodeploy-lambda:
    code: autodeploy-lambda
    handler: autodeploy.autodeploy_handler
    runtime: python
    description: Triggers a deployment to instances launched with certain Tags
    timeout: 300
    policies:
      ec2:
        Version: "2012-10-17"
        Statement:
          -
            Action:
              - "ec2:DescribeInstances"
              - "ec2:CreateTags"
              - "ec2:DeleteTags"
            Resource: "*"
            Effect: "Allow"
      cd:
        Version: "2012-10-17"
        Statement:
          -
            Action:
              - "codedeploy:GetDeploymentGroup"
              - "codedeploy:GetDeploymentConfig"
              - "codedeploy:GetApplicationRevision"
              - "codedeploy:CreateDeployment"
              - "codedeploy:CreateDeploymentGroup"
              - "codedeploy:DeleteDeploymentGroup"
              - "iam:PassRole"
            Resource: "*"
            Effect: "Allow"
